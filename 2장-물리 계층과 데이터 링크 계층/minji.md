# 이더넷

## 이더넷 표준

- 이더넷: 다양한 통신 매체의 규격들과 송수신되는 프레임의 형태, 프레임을 주고받는 방법 등이 정의된 네트워크 기술
- 현대 LAN, 특히 유선 LAN 환경에서 가장 대중적으로 사용됨
- IEEE(전기전자공학자협회)라는 국제 조직이 이더넷 관련 기술을 **IEEE 802.3** 이라는 이름으로 표준화 함
- 이더넷 표준에 따라 지원되는 네트워크 장비, 통신 매체 종류와 전송 속도 등이 달라질 수 있음

<br/><br/>

## 통신 매체 표기 형태

**전송속도BASE-추가특성** 과 같이 표기(ex.1000BASE-SX)

### 전송속도

- 숫자는 Mbps 를 기본으로 함
- G가 붙을 경우 Gbps를 의미
- 100Mbps 가량의 속도를 지원하는 표준들을 고속 이더넷이라고 부르며 1Gbps 가량의 속도를 지원하면 기가 비트 이더넷이라 통칭함

### BASE

- 베이스밴드(BASEband)의 약자로 변조 타입을 의미
- LAN 환경에서는 대부분 베이스밴드 방식을 사용하므로 대부분의 이더넷 통신 매체는 BASE 를 기본으로 사용
- 브로드밴드(BROAD), 패스밴드(PASS) 등도 있음

### 추가 특성

- 전송 가능한 최대거리, 물리 계층 인코딩 방식, 비트 신호를 옮길 수 있는 전송로 수(레인 수) 등이 포함
- 통신 매체의 종류가 명시되기도 함

<br/><br/>

## 통신 매채 종류

| 추가 특성 표기(통신 매체 종류) | 케이블 종류            |
| ------------------------------ | ---------------------- |
| C                              | 동축 케이블            |
| T                              | 트위스티드 페어 케이블 |
| S                              | 단파장 광섬유 케이블   |
| L                              | 장파장 광섬유 케이블   |

- ex. 10BASE-T 케이블: 10Mbps 속도를 지원하는 트위스티드 페어 케이블
- 이더넷 표준과 통신 매체가 일대일로 대응되는 것은 아님

<br/><br/>

## 이더넷 프레임

이더넷 네트워크에서 호스트가 데이터 링크 계층에서 주고받는 프레임

- 캡슐화를 통해 만들어지고 상위 계층으로 전달할 때 역캡슐화 과정을 거침
- 프레임 헤더는 프리앰블, 수신지 MAC 주소, 송신지 MAC 주소, 타입/길이로 구성, 페이로드는 데이터, 트레일러는 FCS 로 구성
  - FCS: 에러 확인 비트

### 프리앰블(preamble)

프레임의 시작을 알리는 8바이트 크기의 정보

- 첫 7바이트는 10101010 값을 가지고, 마지막 바이트는 10101011의 값을 가짐
- 수신지는 이 프리앰블을 통해 이더넷 프레임이 오고 있음을 알아차림 -> 송수신지 동기화를 위해 사용

### 수신지 MAC 주소와 송신지 MAC 주소

물리적 주소라고도 불리는 6바이트 길이의 정보로 LAN 내 수신지, 송신지를 특정할 수 있음

- MAC 주소는 일반적으로 고유하고, 일반적으로 변경되지 않는 주소
- MAC 주소는 네트워크 인터페이스마다 부여되고 NIC(Network Interface Controller)라는 장치가 네트워크 인터페이스 역할을 담당함
- 한 컴퓨터에 NIC 가 여러개 있다면 MAC 주소도 여러개일 수 있음

### 타입/길이

- 필드에 명시된 크기가 1500 이하일 경우 이 필드는 프레임의 크기(길이)를 나타냄
- 필드에 명시된 크기가 1536 이상일 경우에는 타입을 나타냄
- 1500 초과 1536 미만은 사용하지 않음. 타입의 최솟값이 1536 이고 그 사이는 특별한 규칙이 없음
- 타입: 이더넷 프레임이 어떤 정보를 캡슐화했는지 나타내는 정보로 상위 계층에서 사용된 프로토콜의 이름이 명시됨(ex.0800 은 프로토클 IPv4)

### 데이터

- 상위 계층에서 전달받았거나 상위 계층으로 전달해야할 내용
- 네트워크 계층의 데이터와 헤더를 합친 PDU 가 이곳에 포함
- 최대 크기는 1500 바이트로 최소 46바이트 이상이어야 하므로 크기를 맞추기 위해 패딩을 사용함(보통 0으로 채움)

### FCS(Frame Check Sequence)

수신한 이더넷 프레임에 오류가 있는지 확인하기 위한 필드

- 데이터 링크 계층에서의 오류 검출이 이 비트를 통해 이루어짐
- CRC(Cycle Redundancy Check) 라는 순환 중복 검사라고 불리는 오류용 검출값이 들어감
  - 송신지는 프리앰블을 제외한 나머지 필드 값을 바탕으로 CRC 를 계산한 후 FCS 필드에 명시
  - 수신지는 프리앰블과 FCS 필드를 제외한 나머지 필드 값으로 CRC 를 계싼한 후 FCS 필드와 비교
  - 비교값이 일치하지 않으면 프레임에 오류가 있다고 판단 후 프레임 폐기

### 토큰링

이더넷 외 다른 LAN 기술로 호스트들끼리 링 형태로 연결되어 토큰이라는 특별한 정보를 주고 받고, 토큰이 있어야만 메시지를 송신할 수 있음

<br/><br/><br/><br/>

# NIC와 케이블

## NIC

유무선 통신 매체를 연결하고 정보를 변환하는 네트워크 장비

### NIC의 생김새

- 인터페이스 카드, 네트워크 어댑터, LAN 카드 등 다양한 명칭으로 불림
- 초기 NIC 는 확장 카드 형태로 따로 연결하여 사용했음
- USB 로 연결하거나 마더모드에 내장된 경우도 있음
- 마더보드: CPU, 메모리, 보조기억장치 등 컴퓨터 주요 부품을 연결할 수 있는 판으로 흔히 메인보드라고 부름

<br/><br/>

## 트위스티드 페어 케이블

구리 선으로 전기 신호를 주고 받는 통신 매체

- 대중적인 LAN 케이블
- 케이블 본체와 커넥터로 이루어져 있고, RJ-45 라는 커넥터를 주로 활용함
- 케이블 본체는 구리 선이 두가닥씩 꼬여있고, 구리 선으로 만들었기 때문에 전기 신호를 왜곡시킬 수 있는 간섭, 노이즈가 생길 수 있음
- 구리선 주변을 감싸 노이즈를 감싸는 걸 차폐라고 하고, 차폐에는 브레이드 실드, 포일 실드가 사용됨
  - STP: 브레이드 실드 사용
  - FTP: 포일 실드 사용
  - UTP: 아무것도 감싸지 않음
  - S/FTP 케이블이 케이블 외부는 브레이드 실드, 구리선 쌍은 포일 실드로 감싸는 것처럼 케이블 외부와 구리선 쌍을 다른 실드로 감쌀 수 있고 SF/FTP 케이블이 케이블 외부에 브레이드 실드, 포일 실드를 모두 쓰는 것처럼 케이블 외부를 감싸는 실드의 종류는 두 개 일 수 있음
- 카테고리에 따라 분류가 가능
  - Category를 Cat 으로 줄여 표기하는 경우가 많고 Cat 에 따라 지원 대역폭, 주요 대응 규격, 전송 속도와 같은 성능이 달라짐. 카테고리가 높을 수록 지원 가능한 대역폭이 높아짐 -> 송수신 가능 데이터 양이 많고, 더 빠르게 전송이 가능

<br/><br/>

## 광섬유 케이블

- 전기 신호를 이용하는 케이블에 비해 속도도 빠르고 먼 거리까지 전송이 가능하며 노이즈 간섭 영향도 적음 -> 대륙간 네트워크 연결에도 사용
- 커넥터 본체와 커넥터로 이루어져있고 트위스티드 페어 케이블에 비해 커넥터 종류가 더 다양함
  - LC, SC, FC, ST 등의 커넥터가 있음
- 광섬유는 코어와 클래딩으로 구성되어 있고, 코어는 실질적으로 빛이 흐르는 부분, 클래딩은 코어를 둘러싸 빛이 코어 안에서만 흐르도록 하는 역할을 함. 둘의 굴절률 차를 만들어 빛을 코어 내부에 가두는 원리
- 코어의 지름에 따라 싱글 모드 광섬유 케이블과 멀티 모드 광섬유 케이블로 나뉨

### 싱글 모드 광섬유 케이블

- 지름: 8 ~ 10 µm
- 코어의 지름이 작아 빛의 이동 경로가 하나 이상을 갖기 어려움
- 신호 손실이 적어 장거리 전송에 적합하고, 멀티 모드에 비해 비용이 높음
- 파장이 긴 장파장의 빛을 사용함
- 대부분의 케이블 본체에 노란색과 파란색을 띠고 있음

### 멀티 모드 광섬유 케이블

- 지름: 50 ~ 62.5 µm
- 빛이 여러 로로 여러 경로로 이동할 수 있음
- 신호 손실이 커 장거리 전송인 부적합함
- 단파장의 빛을 사용함
- 대부분의 케이블 본체에 오렌지색, 아쿠아색을 띠고 있음

<br/><br/><br/><br/>

# 허브

## 주소 개념이 없는 물리 계층

- 송수신지를 특정할 수 있는 주소는 데이터 링크 계층부터 존재함
- 물리 계층은 송수신되는 정보에 어떤 조작이나 판단을 하지 않음

<br/><br/>

## 허브

여러 대의 호스트를 연결하는 장치로, 리피터 허브라고 부르기도 함

- 이더넷 네트워크의 허브는 이더넷 허브라고 불림
- 포트: 커넥터를 연결할 수 있는 네 개의 연결지점으로 포트에 호스트와 연결된 통신 매체를 연결할 수 있음
- 리피터: 전기 신호가 감소하거나 왜곡되는 걸 방지하기 위해 전기 신호를 증폭시켜주는 장치. 신호에 대해 어떤 판단이나 조작을 하지 않음
- 오늘날 인터넷 환경에서 잘 쓰이지 않음

### 허브의 특징

1. 전달 받은 신호를 다시 모든 포트로 그대로 내보냄
2. 반이중 모드로 통신(송수신을 번갈아 가면서 함)

### 콜리전 도메인

충돌(collision)이 발생할 수 있는 영역

- 허브에 호스트가 많이 연결되어 있을 수록 충돌 발생 가능성이 높음
- 콜리전 도메인은 작을수록 충돌이 발생할 가능성이 줄어들기 때문에 좋음
- CSMA/CD 프로토콜을 사용하거나 스위치 장비를 사용해 콜리전 도메인으로 인한 충돌 문제를 해결함

<br/><br/>

## CSMA/CD

반이중 이더넷을 대표하는 송수신 방법

- CS(Carrier Sense): 현재 통신 매체의 사용 가능 여부를 체크. 캐리어 감지
- MA(Multiple Access): 복수의 호스트가 네트워크에 접근하려는 상황으로 이때 충돌이 발생. 다중 접근
- CD(Collision Detection): 충돌이 감지되면 전송이 중단되고 충돌을 검출한 호스트는 다른 이들에게 충돌이 발생했음을 알리고자 잼 신호라는 특별한 신호를 보냄. 임의의 시간동안 기다린 뒤 다시 전송함. 충돌 검출

<br/><br/><br/><br/>

# 스위치

데이터 링크 계층의 네트워크 장비로 L2 스위치라고도 함

- 특정 MAC 주소를 가진 호스트에만 프레임을 전달할 수 있게 함
- 전이중 모드의 통신을 지원함 -> 포트별 콜리전 도메인이 분리가 되어 CSMA/CD 프로토콜이 불필요함
- MAC 주소 학습: 특정 포트와 해당 포트에 연결된 호스트의 MAC 주소와의 관계를 기억하여 원하는 호스트에만 프레임을 전달함
- MAC 주소 테이블: 스위치의 포트와 연결된 호스트의 MAC 주소 연관 관계를 나타내는 표 형태의 정보

## MAC 주소 학습

플러딩, 포워딩과 필터링 에이징의 세 가지 기능을 통해 MAC 주소 테이블을 유지하고 원하는 포트에만 프레임을 내보낼 수 있게 됨

- 플러딩: 허브처럼 송신지 포트를 제외한 모든 포트로 프레임을 전송
- 필터링: 전달받은 프레임을 어디로 내보내고, 어디로 내보내지 않을지 결정하는 것
- 포워딩: 전송될 포트에 실제로 프레임을 내보내는 것
- 에이징: MAC 주소 테이블에 등록된 특정 포트에서 일정 시간동안 프레임을 전송받지 못했다면 해당 항목 삭제

### 프레임 전송 과정

1. 처음엔 어떤 포트에 어떤 MAC 주소를 가진 호스트가 연결되어 있는지 모름
2. 플러딩 진행한 후 관련 없는 프레임을 전송 받은 호스트는 폐기함<br/>
3. 관련 있는 프레임을 받은 호스트는 스위치로 응답 프레임을 전송 -> 송수신하는 호스트의 MAC 주소와 포트를 알게됨

### 브리지

네트워크 영역을 구획하여 콜리전 도메일을 나누거나 네트워크를 확장하는 용도로 사용되는 네트워크 장비

- 스위치들의 기능인 포워딩, 필터링 기능을 수행할 수 있음
- 스위치를 통해서도 충분히 브리지의 역할을 수행할 수 있어 사용 빈도가 줄고 있음(심지어 스위치가 더 역할이 많고, 프레임 처리 성능이 더 우수함)

<br/><br/>

## VLAN(Virtual LAN)

한 대의 스위치를 통해 가상의 LAN 을 만드는 방법

- 한 대의 물리적 스위치라고 해도 여러 대의 스위치가 있는 것처럼 논리적인 단위로 LAN 을 구획할 수 있음
- VLAN 을 통해 구획된 각 VLAN들 끼리 통신을 하려면 데이터 링크 이상의 상위 계층 장비가 필요함
- 각 VLAN 은 서로 다른 네트워크로 간주하기 때문에 브로드캐스트 도메인 달라짐

### 포트 기반 VLAN

스위치의 포트가 VLAN 을 결정하는 방식으로, 사전에 특정 포트에 VLAN 을 할당하고 해당 포트에 호스트를 연결함으로써 VLAN에 포함시키는 방식

- 한 대의 스위치만으로 포트 기반 VLAN 을 나누면 포트 수가 부족해질 수 있음
- VLAN 트렁킹: 두 대 이상의 VLAN 스위치를 효율적으로 연결하여 확장하는 방법. 스위치 간의 통신을 위한 특별한 포인트인 트렁크 포트에 VLAN 스위치를 연결하는 방식
- 트렁크 포트로 인해 전달받은 프레임은 스위치가 아직 학습되지 않은 MAC 주소를 포함하고 있을 경우 일반적인 이더넷 프레임만으론 어떤 VLAN에 속하는건지 알 수 없음. 따라서 어떤 VLAN 에 속하는지에 대한 정보(VLAN 태그)까지 추가로 확장된 이더넷 프레임을 사용하고, 이를 802.1Q 프레임이라고 함

### MAC 기반 VLAN

사전 설정된 MAC 주소에 따라 VLAN 이 결정되는 방식으로, 포트가 VLAN 을 결정하는 것이 아니라 송수신하는 프레임 속 MAC 주소가 호스트가 속할 VLAN 을 결정하는 방식
